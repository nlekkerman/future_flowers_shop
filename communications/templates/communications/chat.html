{% extends 'base.html' %}

{% block content %}
<h2>Chat with {{ conversation.superuser }}</h2>
<div id="chat-messages">
    {% for chat_message in chat_messages %}
    <div class="message {% if chat_message.sender == request.user %}sent{% else %}received{% endif %}">
        <p>
            <strong>
                {% if request.user.is_superuser %}
                    {% if chat_message.sender == chat_message.conversation.user %}
                        {{ chat_message.sender.username }}:
                    {% else %}
                        {{ chat_message.sender.username }}:
                    {% endif %}
                {% else %}
                    {% if chat_message.sender == request.user %}
                        {{ request.user.username }}:
                    {% else %}
                        Chat:
                    {% endif %}
                {% endif %}
            </strong>
            {{ chat_message.content }}
        </p>
        <p class="timestamp">{{ chat_message.sent_at }}</p>
    </div>
    {% endfor %}
</div>


<div id="message-form" class="{% if show_form %}make-visible{% else %}hidden{% endif %}">
    <h3>Send a new message</h3>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn">Send</button>
    </form>
</div>



{% endblock %}
