{% extends "base.html" %}
{% load static %}

{% block content %}
<!-- Navigation copied from home.html -->
<div class="navigation-container">
    {% include 'navigation.html' %}

</div>

<!-- Rest of the cart.html content -->
<div class="cart-container">
    <h2 class="cart-title">Shopping Cart</h2>

    {% if cart.items.all %}
    <table class="cart-table">
        <thead>
            <tr>
                <th class="cart-header">Image</th>
                <th class="cart-header">Product</th>
                <th class="cart-header">Price</th>
                <th class="cart-header">Quantity</th>
                <th class="cart-header">Total</th>
                <th class="cart-header">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart.items.all %}
            <tr class="cart-item">
                <td class="cart-item-image">
                    {% if item.seed.image %}
                    <img src="{{ item.seed.image.url }}" alt="{{ item.seed.name }}" class="item-image">
                    {% else %}
                    <img src="{% static 'images/default-image.jpg' %}" alt="Default Image" class="item-image">
                    {% endif %}
                </td>
                <td class="cart-item-name">
                    <span>{{ item.seed.name }}</span>
                    <p>{{ item.seed.description|truncatewords:10 }}</p>
                </td>
                <td class="cart-item-price">{{ item.seed.calculate_discounted_price }}</td>
                <td class="cart-item-quantity">
                    <form action="{% url 'update_cart_item' item.seed.id %}" method="post" class="update-form">
                        {% csrf_token %}
                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="quantity-input">
                        <button type="submit" class="btn btn-update">Update</button>
                    </form>
                </td>
                <td class="cart-item-total">{{ item.get_total_price }}</td>
                <td class="cart-item-remove">
                    <form action="{% url 'remove_from_cart' item.seed.id %}" method="post" class="remove-form">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-remove">Remove</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="cart-summary">
        <h3>Total: <span class="cart-total">{{ cart.get_total_price }}</span></h3>
        <h3>Discount: <span class="cart-discount">{{ cart.get_total_discount }}</span></h3>
        <div class="checkout-actions">
            <a href="#" class="btn btn-checkout">Proceed to Checkout</a>
        </div>
    </div>
    {% else %}
    <div class="empty-cart-message">
        <h3>Your cart is currently empty.</h3>
        <a href="{% url 'shop' %}" class="btn btn-shop">Start Shopping</a>
    </div>
    {% endif %}
</div>
{% endblock %}
